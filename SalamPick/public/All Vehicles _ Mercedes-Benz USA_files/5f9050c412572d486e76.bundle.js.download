"use strict";(self.webpackChunk_mbusa_now_aem=self.webpackChunk_mbusa_now_aem||[]).push([[7842],{49715:function(e,t){t.Z={ADDRESS_LINE:{id:"ADDRESS_LINE",labelId:"addressLine1",messageId:"informationError"},ADDRESS_APARTMENT:{id:"ADDRESS_APARTMENT",labelId:"addressApartment",messageId:"sectionError"},ADDRESS_APARTMENT_SUITE:{id:"ADDRESS_APARTMENT_SUITE",labelId:"addressApartmentSuite",messageId:"sectionError"},ADDRESS_PO_BOX:{id:"ADDRESS_PO_BOX",labelId:"addressPOBox",messageId:"sectionError"},ADDRESS_PO_BOX_STREET_ADDRESS:{id:"ADDRESS_PO_BOX_STREET_ADDRESS",labelId:"addressPOBoxStreetAddress",messageId:"sectionError"},ADDRESS_RURAL_ROUTE_LENGTH:{id:"ADDRESS_RURAL_ROUTE_LENGTH",labelId:"addressRuralRouteLength",messageId:"sectionError"},ADDRESS_RURAL_ROUTE_REQUIRED:{id:"ADDRESS_RURAL_ROUTE_REQUIRED",labelId:"addressRuralRouteRequired",messageId:"informationError"},ADDRESS_STREET_NAME_EMPTY:{id:"ADDRESS_STREET_NAME_EMPTY",labelId:"addressStreetNameEmpty",messageId:"informationError"},ADDRESS_STREET_NAME_LENGTH:{id:"ADDRESS_STREET_NAME_LENGTH",labelId:"addressStreetNameLength",messageId:"sectionError"},ADDRESS_STREET_NUMBER_EMPTY:{id:"ADDRESS_STREET_NUMBER_EMPTY",labelId:"addressStreetNumberEmpty",messageId:"informationError"},ADDRESS_STREET_NUMBER_LENGTH:{id:"ADDRESS_STREET_NUMBER_LENGTH",labelId:"addressStreetNumberLength",messageId:"sectionError"},ADDRESS_SUITE:{id:"ADDRESS_SUITE",labelId:"addressSuite",messageId:"sectionError"},HOME_PHONE:{id:"HOME_PHONE",labelId:"homePhone",messageId:"informationError"},HOME_PHONE_AREA:{id:"HOME_PHONE_AREA",labelId:"homePhone",messageId:"informationError"},BUSINESS_PHONE:{id:"BUSINESS_PHONE",labelId:"businessPhone",messageId:"informationError"},BIRTHDAY:{id:"BIRTHDAY",labelId:"birthday",messageId:"informationError"},DEALER_NOT_ENROLLED_IN_DT:{id:"DEALER_NOT_ENROLLED_IN_DT",labelId:"dealerNotEnrolledInDT",messageId:"dealerNotEnrolledInDT",contactDealerId:"dealerNotEnrolledInDT",canIgnore:!0},SSN:{id:"SSN",labelId:"ssnError",messageId:"informationError",message:"Invalid SSN"},ZIP_CODE_STATE:{id:"ZIP_CODE_STATE",labelId:"zipCodeState",messageId:"zipCodeState"},DEALER_API_ERROR:{id:"DEALER_API_ERROR",labelId:"dealerAPIError",messageId:"dealerAPIError"}}},20716:function(e,t,a){a.d(t,{Z:function(){return i}});var n=a(15671),r=a(43144),s=a(80662),i=function(){function e(t,a,r){(0,n.Z)(this,e),this.element=t,this.dealer=a,this.map=null,this.isPreferredDealer=r,this.createMap()}return(0,r.Z)(e,[{key:"destroy",value:function(){this.map&&this.map.destroyMap(),this.map=null}},{key:"createMap",value:function(){var e={center:{lat:parseFloat(this.dealer.location.lat),lng:parseFloat(this.dealer.location.lng)},streetViewControl:!1,zoomControl:!1};this.map=new s.b6({element:this.element,config:e,onMapCreatedCallback:this.addDealerMarker.bind(this),markerClickCallback:this.onMarkerClick.bind(this)})}},{key:"addDealerMarker",value:function(){var e=Object.assign({},this.dealer);e.icon=this.isPreferredDealer?"/etc/designs/mb-nafta/images/icon-mb-dealer-location_denim.png":"/etc/designs/mb-nafta/images/icon-mb-dealer-location_black.png",this.map.addMarkers([e],!0)}},{key:"onMarkerClick",value:function(){window.open(this.dealer.directionsLink)}}]),e}()},97842:function(e,t,a){a.d(t,{Z:function(){return te}});var n=a(87757),r=a.n(n),s=a(15861),i=a(15671),l=a(43144),o=a(82963),c=a(61120),d=a(97326),h=a(60136),u=a(4942),E=a(48218),g=a(8357),m=a(92059),v=a(16266),S=a(87491),p=a(80662),f=a(70816),D=a(49715),y={country:window.mbNafta.ns("pageData").country,dealerSearchBar:{buttonStyle:"button button_secondary"},distanceUnit:window.mbNafta.ns("pageData","applicationProperties","distance").distanceUnit||"Mile",distanceUnitAbbr:window.mbNafta.ns("pageData","applicationProperties","distance").distanceUnitAbbr||"mi",language:window.mbNafta.ns("pageData").language,presetDealerEnableChange:!1,presetDealerId:null,showMap:!0,showInventory:!0},_=Object.assign(y,window.mbNafta.ns("pageData","chooseADealerPlugin").config),b=_.country,I=_.dealerSearchBar.buttonStyle,L=_.distanceUnit,R=_.distanceUnitAbbr,C=_.language,w=_.presetDealerId,A={country:b,dealerSearchBar:{buttonStyle:I},distanceUnit:L,distanceUnitAbbr:R,language:C,presetDealerEnableChange:_.presetDealerEnableChange,presetDealerId:w,showMap:_.showMap,showInventory:_.showInventory},T=Object.assign({find:"Find",searchInputLabel:"Postal Code or City, Province",searchInputLabelUS:"Zip Code",dealerSearchErrorMessage:"Invalid Postal Code or City, Province",dealerSearchErrorMessageUS:"Invalid Zip Code",dealerValidationError:"The dealer is currently unavailable.",emptyDealerErrorMessage:"Please select a dealer to continue.",dealerSearchHeading:"Search for your preferred dealer.",dealerResultHeading:"Select one of the dealers near {0}.",closestDealersHeading:"These are the closest dealers based on your search.",selectedDealerHeading:"This is your selected dealer.",changeDealer:"Change Dealer",changeLocation:"Change Location",viewInventory:"View Dealer Inventory",amgPerformanceCenter:"AMG Performance Center",amgPerformanceCenterElite:"AMG Performance Center Elite",serverErrorDescription:"We were unable to process your request. Please try again.",serverErrorTitle:"We're sorry, an error has occurred.",suggestedDealer:"Suggested"},window.mbNafta.ns("pageData").localization),k={find:T.find,searchInputLabel:T.searchInputLabel,searchInputLabelUS:T.searchInputLabelUS,dealerSearchErrorMessage:T.errorMessage,dealerSearchErrorMessageUS:T.errorMessageUS,dealerValidationError:T.dealerValidationError,emptyDealerErrorMessage:T.emptyDealerErrorMessage,dealerSearchHeading:T.dealerSearchHeading,dealerResultHeading:T.dealerResultHeading,dealerResultsSubHeading:T.dealerResultsSubHeading,closestDealersHeading:T.closestDealersHeading,selectedDealerHeading:T.selectedDealerHeading,changeDealer:T.changeDealer,changeLocation:T.changeLocation,viewInventory:T.viewInventory,amgPerformanceCenter:T.amgPerformanceCenter,amgPerformanceCenterElite:T.amgPerformanceCenterElite,serverErrorDescription:T.serverErrorDescription,serverErrorTitle:T.serverErrorTitle,suggestedDealer:T.suggestedDealer},N=a(83224),M=a(30168);function O(){var e=(0,M.Z)(['\n    <div class="dealer-results">\n        ','\n        <div data-dealer-heading></div>\n        <p class="dealer-results__sub-heading-copy dealer-results__sub-heading-copy">\n            <button class="link link_plain-link" data-change-search-cta role="presentation"\n               data-analytics-trigger="change-zip">\n                ','\n            </button>\n        </p>\n        <div data-dealer-results-list></div>\n        <span id="error','" class="dealer-results__error-message" role="alert" aria-live="polite" data-error-message></span>\n    </div>\n']);return O=function(){return e},e}function P(){var e=(0,M.Z)(["\n    ","\n"]);return P=function(){return e},e}function H(){var e=(0,M.Z)(['\n    <ul class="dealer-results__list">\n    </ul>\n']);return H=function(){return e},e}function B(){var e=(0,M.Z)(['\n    <li class="dealer-result-list-item ','" data-analytics-trigger="contact-dealer-select-','" tabindex="0">\n    ',"\n    </li>\n"]);return B=function(){return e},e}var U="aria-invalid",V="aria-describedby",Z=function(){function e(){var t,a,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=r.dealer,l=r.onSelectCallback,o=arguments.length>1?arguments[1]:void 0,c=arguments.length>2?arguments[2]:void 0,d=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,i.Z)(this,e),this.dealerData=s,this.onSelectCallback=l,this.errorMessageId=c,this.element=function(e){var t=e.dealer,a=e.country,n=e.dealerIcon;return(0,g.e2)(B(),"",t.name,"us"===a?'<div class="dealer-result-list-item__address-container credit-dealer-result-container\n    '.concat(n&&n.DealerIconTitle.fileReference?"__hide-mb-pin-icon":"",'">\n    ').concat(n&&n.DealerIconTitle.fileReference?'<img src="'.concat(n&&n.DealerIconTitle.fileReference,'"\n        class="dealer-icon" alt="').concat(n&&n.DealerIconTitle.altText,'"/>'):"",'\n    <div class="dealer-text">\n        <div>\n            <span class="dealer-result-list-item__dealer-name">').concat(t.name,'</span>\n        </div>\n        <div class="dealer-result-list-item__address">').concat(t.address,'</div>\n        <div class="dealer-result-list-item__address">').concat(t.city,", ").concat(t.state," ").concat(t.zip,'</div>\n        <a class="link link_plain-link dealer-credit-flow" href="tel:').concat(t.phone,'">').concat(t.phone,'</a>\n        <div class="dealer-result-list-item__error" id="dealerError-').concat(t.dealerId,'"/>\n    </div>\n</div>'):'<div class="dealer-result-list-item__address-container">\n            <div>\n                <span class="dealer-result-list-item__dealer-name">'.concat(t.name,'</span>\n                <span class="dealer-result-list-item__dealer-distance">').concat(t.distance,'</span>\n            </div>\n            <div class="dealer-result-list-item__address">').concat(t.address,", ").concat(t.city,", ").concat(t.state," ").concat(t.zip,'</div>\n            <div class="dealer-result-list-item__error" id="dealerError-').concat(t.dealerId,'"/>\n        </div>'))}({dealer:this.dealerData,content:o,country:window.mbNafta.pageData.country,isCreditApp:d,dealerIcon:null===(t=window.mbNafta.pageData)||void 0===t||null===(a=t.businessCreditApplication)||void 0===a||null===(n=a.content)||void 0===n?void 0:n.spaBusinessCreditApplication})({getNode:!0}),this.onDealerSelect=this.onDealerSelect.bind(this),this.attachEvents()}return(0,l.Z)(e,[{key:"destroy",value:function(){this.detachEvents()}},{key:"onDealerSelect",value:function(e){var t=e.which;e.type!==E.FP.CLICK&&t!==E.sd.ENTER||this.onSelectCallback(this.dealerData)}},{key:"attachEvents",value:function(){this.element.addEventListener(E.FP.CLICK,this.onDealerSelect),this.element.addEventListener(E.FP.KEYDOWN,this.onDealerSelect)}},{key:"detachEvents",value:function(){this.element.removeEventListener(E.FP.CLICK,this.onDealerSelect),this.element.addEventListener(E.FP.KEYDOWN,this.onDealerSelect)}},{key:"setErrorState",value:function(e){e&&this.element?(this.element.setAttribute(U,"true"),this.element.setAttribute(V,"error".concat(this.errorMessageId)),this.element.focus()):this.element&&(this.element.removeAttribute(U),this.element.removeAttribute(V))}},{key:"render",value:function(){return this.element}}]),e}(),j=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;(0,i.Z)(this,e),this.content=a,this.dealers=[],this.errorMessageId=n,this.element=(0,g.e2)(H())({getNode:!0}),this.createDealers(t,a)}return(0,l.Z)(e,[{key:"createDealers",value:function(e,t){var a=this;e.forEach((function(e){var n=new Z(e,t,a.errorMessageId);g.jG.append(n.render(),a.element),a.dealers.push(n)}))}},{key:"showErrorMessageOnDealer",value:function(e){var t=this.element.querySelector("#dealerError-".concat(e));t&&(t.innerHTML='<div class="error">'.concat(this.content.dealerValidationError,"</div>"))}},{key:"render",value:function(){return this.element}},{key:"focus",set:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&this.dealers.length&&this.dealers[0].setErrorState(!0)}}]),e}(),F="error",G=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.content,n=t.country,r=t.filter,s=t.language,l=t.model,o=t.onDealerSelectCallback;(0,i.Z)(this,e),this.content=a,this.country=n,this.filter=r,this.language=s,this.model=l,this.onDealerSelectCallback=o,this.errorMessageId=(0,g.fV)(),this.element=function(e){var t=e.changeLocationLabel,a=e.dealerResultsSubHeading,n=e.id,r=void 0===n?(0,g.fV)():n;return(0,g.e2)(O(),a?'<h3 class="leads-form__sub-heading">'.concat(a,"</h3>"):"",t,r)}({changeLocationLabel:this.content.changeLocation,dealerResultsSubHeading:this.content.dealerResultsSubHeading,id:this.errorMessageId})({getNode:!0}),this.dealerResultsListContainer=null,this.changeSearchElem=null,this.changeSearchHandler=this.changeSearchHandler.bind(this),this.createDealerResultsList=this.createDealerResultsList.bind(this),this.renderDealerResultsList=this.renderDealerResultsList.bind(this),this.cacheDOM(),this.attachEvents(),this.searchDealers()}return(0,l.Z)(e,[{key:"destroy",value:function(){this.detachEvents(),this.dealerResultsListContainer=null,this.changeSearchElem=null}},{key:"cacheDOM",value:function(){this.dealerResultsListContainer=this.element.querySelector("[".concat("data-dealer-results-list","]")),this.changeSearchElem=this.element.querySelector("[".concat("data-change-search-cta","]")),this.dealerResultHeading=this.element.querySelector("[".concat("data-dealer-heading","]")),this.errorMessageElm=this.element.querySelector("[".concat("data-error-message","]"))}},{key:"attachEvents",value:function(){this.changeSearchElem.addEventListener(E.FP.CLICK,this.changeSearchHandler)}},{key:"detachEvents",value:function(){this.changeSearchElem&&this.changeSearchElem.removeEventListener(E.FP.CLICK,this.changeSearchHandler)}},{key:"changeSearchHandler",value:function(){this.model.setCurrentStep(1)}},{key:"setLoadingSpinner",value:function(){var e=new N.T({isInline:!0}),t=document.createElement("div");t.classList.add("dealer-results-list__loading-list"),t.appendChild(e.render()),g.jG.insert(t,this.dealerResultsListContainer)}},{key:"getSearchFilter",value:function(){return this.filter?this.filter:"mx"===this.country?"sales":"mbDealer"}},{key:"getSearchResultCount",value:function(){return"mx"===this.country?15:9}},{key:"searchDealers",value:function(){var e=this;this.setLoadingSpinner();var t={country:this.country,language:this.language,searchByType:this.model.state.searchByType,searchLocation:this.model.state.searchLocation,start:0,count:this.getSearchResultCount(),filter:this.getSearchFilter()};return S.a.getDealersAlt(t).then((function(t){return t.results.map((function(t){return{dealer:t,onSelectCallback:e.onDealerSelectCallback}}))})).catch((function(t){console.log(t),e.showServerErrorMessage()})).then(this.createDealerResultsList).then(this.renderDealerResultsList)}},{key:"createDealerResultsList",value:function(e){this.renderHeader(e),this.dealerResultsList=new j(e,this.content,this.errorMessageId)}},{key:"renderDealerResultsList",value:function(){g.jG.insert(this.dealerResultsList.render(),this.dealerResultsListContainer),this.model.state.autoSubmit||this.element.querySelector(".".concat("dealer-result-list-item")).focus()}},{key:"renderHeader",value:function(e){if(e&&e.length>0){var t={hasNearbyDistance:parseFloat(e[0].dealer.distance.split(" "))<=25,dealerResultHeading:this.content.dealerResultHeading,closestDealersHeading:this.content.closestDealersHeading,searchLocation:this.model.state.searchString};g.jG.insert((n=(a=t).dealerResultHeading,r=a.closestDealersHeading,s=a.searchLocation,i=a.hasNearbyDistance,(0,g.e2)(P(),i?function(e,t){return'<h3 class="dealer-results__sub-heading">'.concat((0,g.NR)(e,[t]),"</h3>")}(n,s):function(e,t){return'<h3 class="dealer-results__sub-heading">'.concat(t,"</h3>")}(0,r)))({getNode:!0}),this.dealerResultHeading)}var a,n,r,s,i}},{key:"showErrorMessage",value:function(){this.element.classList.add("".concat(F)),this.errorMessageElm.innerText=this.content.emptyDealerErrorMessage}},{key:"showServerErrorMessage",value:function(){this.element.classList.add("".concat(F)),this.errorMessageElm.innerHTML="<div>".concat(this.content.serverErrorTitle,"</div><div>").concat(this.content.serverErrorDescription,"</div>")}},{key:"showErrorMessageOnDealer",value:function(e){this.dealerResultsList.showErrorMessageOnDealer(e)}},{key:"render",value:function(){return this.element}},{key:"focus",set:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&this.dealerResultsList&&(this.dealerResultsList.focus=!0)}}]),e}(),z=a(20716),x=a(12641);function Y(){var e=(0,M.Z)(['\n    <div>\n        <h3 class="choose-a-dealer-plugin__sub-heading">','</h3>\n        <p class="choose-a-dealer-plugin__sub-heading-copy dealer-results__sub-heading-copy ','">\n            <button class="link link_plain-link" data-change-search-cta role="presentation" data-analytics-trigger="change-zip">\n                ','\n            </button>\n        </p>\n        <div class="choose-a-dealer" data-analytics-container="contact-dealer-selected:',":",'">\n            <address class="choose-a-dealer__address-container-dealer ','">\n                ',"\n                ","\n            </address>\n            ","\n            ","\n        </div>\n    </div>\n"]);return Y=function(){return e},e}var q=function(){function e(t){var a=t.model,n=t.chosenDealer,r=t.disableChange,s=t.showMap,l=t.showInventory,o=t.content,c=t.isCreditApp,d=void 0!==c&&c;(0,i.Z)(this,e),this.model=a,this.element=function(e){var t,a,n=e.dealer,r=void 0===n?{}:n,s=e.content,i=e.country,l=e.disableChange,o=void 0!==l&&l,c=e.showMap,d=e.showInventory,h=e.isCreditApp,u=void 0!==h&&h;return(0,g.e2)(Y(),s.selectedDealerHeading,o?"hide":"",s.changeDealer,r.name,r.dealerId,i===x.Z.COUNTRIES.US&&u?"dealerIcon":"",function(e,t,a){return e?'<div>\n            <a href="'.concat(t.url,'"\n            class="choose-a-dealer__dealer-name link link_bold" target="_blank" rel="noopener">').concat(t.name,"</a>\n        </div>\n        ").concat(function(e){var t,a,n,r=null===(t=window.mbNafta.pageData)||void 0===t||null===(a=t.businessCreditApplication)||void 0===a||null===(n=a.content)||void 0===n?void 0:n.spaBusinessCreditApplication;return e&&r?'<img src="'.concat(r.DealerIconTitle.fileReference,'" class="dealer-icon" alt="').concat(r.DealerIconTitle.altText,'"/>'):""}(a),'\n        <div class="choose-a-dealer__address choose-a-dealer__address--main">').concat(t.address,'</div>\n            <div class="choose-a-dealer__address choose-a-dealer__address--main">').concat(t.city,", ").concat(t.state,", ").concat(t.zip,'</div>\n        <div>\n            <a href="tel:').concat(t.phone,'" class="choose-a-dealer__phone-number">').concat(t.phoneFormatted,"</a>\n        </div>"):'<div>\n            <p class="choose-a-dealer__dealer-name">'.concat(t.name,'</p>\n        </div>\n        <div class="choose-a-dealer__address choose-a-dealer__address--main">').concat(t.address,", ").concat(t.city,", ").concat(t.state,", ").concat(t.zip,"</div>")}(i===x.Z.COUNTRIES.US,r,u),function(e,t,a,n){var r="";return e.isAmg&&(r+='<i class="'.concat(t,' icon-AMG_logo-performance-center">\n                    <span class="offscreen">').concat(a,"</span>\n                </i>")),e.isAmgElite&&(r+='<i class="'.concat(t,' icon-AMG_logo-performance-center-elite">\n                    <span class="offscreen">').concat(n,"</span>\n                </i>")),r}(r,"choose-a-dealer__icon",s.amgPerformanceCenter,s.amgPerformanceCenterElite),d?(t=r.inventoryUrl,a=s.viewInventory,'\n        <a href="'.concat(t,'" class="choose-a-dealer__link link link_secondary" target="_blank" rel="noopener" data-analytics-trigger="cta">\n            ').concat(a,"\n        </a>\n    ")):"",c?'<div class="choose-a-dealer__map" data-dealer-map></div>':"")}({dealer:n,content:o,country:window.mbNafta.pageData.country,disableChange:r,showMap:s,isCreditApp:d,showInventory:l})({getNode:!0}),this.chosenDealer=n,this.changeSearchElem=null,this.map=null,this.changeSearchHandler=this.changeSearchHandler.bind(this),this.cacheDOM(),this.attachEvents(),s&&this.createMap()}return(0,l.Z)(e,[{key:"destroy",value:function(){this.detachEvents(),this.dealerMap&&this.dealerMap.destroy()}},{key:"cacheDOM",value:function(){this.changeSearchElem=this.element.querySelector("[".concat("data-change-search-cta","]")),this.mapElm=this.element.querySelector("[".concat("data-dealer-map","]"))}},{key:"attachEvents",value:function(){this.changeSearchElem.addEventListener(E.FP.CLICK,this.changeSearchHandler)}},{key:"detachEvents",value:function(){this.changeSearchElem.removeEventListener(E.FP.CLICK,this.changeSearchHandler)}},{key:"changeSearchHandler",value:function(){this.model.setCurrentStep(2)}},{key:"createMap",value:function(){this.dealerMap=new z.Z(this.mapElm,this.chosenDealer,!0)}},{key:"render",value:function(){return this.element}}]),e}(),J={chosenDealer:null,currentStep:1,searchByType:null,searchLocation:null,searchString:null,autoSubmit:!1},K=function(e){function t(e){return(0,i.Z)(this,t),e=Object.assign(J,e),(0,o.Z)(this,(0,c.Z)(t).call(this,e))}return(0,h.Z)(t,e),(0,l.Z)(t,[{key:"setSearchByType",value:function(e){this.state.searchByType=e}},{key:"setAutoSubmit",value:function(e){this.state.autoSubmit=e}},{key:"setSearchLocation",value:function(e){this.state.searchLocation=e?e.trim():e}},{key:"setSearchString",value:function(e){this.state.searchString=e}},{key:"setCurrentStep",value:function(e){this.state.currentStep=e}},{key:"setChosenDealer",value:function(e){this.state.chosenDealer=e}}]),t}(m.y);function W(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function X(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?W(Object(a),!0).forEach((function(t){(0,u.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):W(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Q="choose-a-dealer-plugin--search-bar",$="choose-a-dealer-plugin--results-view",ee="choose-a-dealer-plugin--dealer-view",te=function(e){function t(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.Z)(this,t),(e=(0,o.Z)(this,(0,c.Z)(t).call(this))).domElement=a.element||document.getElementById("choose-a-dealer-plugin-container"),e.config=X({},A,{},a),e.content=X({},k,{},a.content),e.id=(0,g.fV)(),e.searchBar=null,e.chosenDealerView=null,e.coupledInstance=!1,e.valid=!0,e.onDealerSelectCallback=e.onDealerSelectCallback.bind((0,d.Z)(e)),e.onChosenDealerValidate=e.onChosenDealerValidate.bind((0,d.Z)(e)),e.setSearchFromLocation=e.setSearchFromLocation.bind((0,d.Z)(e)),e.createView=e.createView.bind((0,d.Z)(e)),e.getInstance=e.getInstance.bind((0,d.Z)(e)),e.initialize(),e}var a,n;return(0,h.Z)(t,e),(0,l.Z)(t,[{key:"initialize",value:(n=(0,s.Z)(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.s.getInstance();case 2:return this.dealerLocationPrioritization=e.sent,e.next=5,this.setupModel();case 5:this.attachEvents(),this.dispatchInited(),this.initView();case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setupModel",value:(a=(0,s.Z)(r().mark((function e(){var t,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.dealerLocationPrioritization.get("CHOOSE_A_DEALER_PLUGIN"),a=this.getLastLocation(),!this.config.presetDealerId){e.next=5;break}return e.next=5,S.a.getDealer({country:this.config.country,id:this.config.presetDealerId,language:this.config.language,type:"dealers"}).then((function(e){t={data:e,receievedFrom:"default",type:"dealer"},a=X({},a,{searchLocation:e.zip,searchByType:"zip"})}));case 5:this.model=new K(Object.assign(a,{chosenDealer:t.data}));case 6:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getLastLocation",value:function(){var e=this.dealerLocationPrioritization.get("CHOOSE_A_DEALER_PLUGIN","CHANGE_DEALER");return e?{searchLocation:e.data,searchByType:e.type}:{}}},{key:"attachEvents",value:function(){this.model.attach(this),g.Jw.addEventListener(E.fD.CHOSEN_DEALER_VALIDATE,this.onChosenDealerValidate),g.Jw.addEventListener(E.fD.CHOSEN_DEALER_GET_INSTANCE,this.getInstance)}},{key:"detachEvents",value:function(){this.model.detach(this),g.Jw.removeEventListener(E.fD.CHOSEN_DEALER_VALIDATE,this.onChosenDealerValidate),g.Jw.removeEventListener(E.fD.CHOSEN_DEALER_GET_INSTANCE,this.getInstance)}},{key:"onUpdate",value:function(e,t){if(e.searchLocation!==t.searchLocation&&t.searchLocation&&(this.searchBar&&this.searchBar.destroy(),this.createResultsView()),e.currentStep!==t.currentStep)switch(t.currentStep){case 1:this.resultsView&&this.resultsView.destroy(),this.chosenDealerView&&this.destroyChosenDealerView(),this.createSearchBar(!1,!0);break;case 2:this.chosenDealerView&&this.destroyChosenDealerView(),this.createResultsView()}t.chosenDealer&&e.chosenDealer!==t.chosenDealer&&(this.createChosenDealerView(t.chosenDealer),this.dispatchChosenDealerUpdated(t.chosenDealer))}},{key:"initView",value:function(){var e=this.model.state,t=e.chosenDealer,a=e.searchLocation,n=e.searchByType,r=t;this.setSearchFromLocation(a,n).then(this.createView.bind(this,r)).catch((function(e){return console.error("Error init of App, ".concat(e))}))}},{key:"setSearchFromLocation",value:function(e,t){return Promise.resolve().then((function(){return e&&"place"===t?p.cJ.getCityStateForPlace(e).then((function(e){return"".concat(e.city,", ").concat(e.region)})):e})).then(this.model.setSearchString.bind(this.model)).catch((function(e){return console.error("Error setting searchString, ".concat(e))}))}},{key:"createView",value:function(e){if(e){var t,a,n=!(null==this||null===(t=this.config)||void 0===t||!t.filter),r=n&&(null==e||null===(a=e.badges)||void 0===a?void 0:a.includes(this.config.filter));n&&r||!n?(this.createChosenDealerView(e),this.dispatchChosenDealerUpdated(e)):this.createSearchBar()}else this.createSearchBar()}},{key:"createSearchBar",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.model.setCurrentStep(1),this.searchBar=new v.D({autoSubmitLocation:e,buttonStyle:this.getButtonStyle(this.config.dealerSearchBar.buttonStyle),country:this.config.country,ctaLabel:this.content.find,dealerSearchErrorMessage:this.config.country===x.Z.COUNTRIES.US?this.content.dealerSearchErrorMessageUS:this.content.dealerSearchErrorMessage,defaultLocation:{searchLocation:this.model.state.searchLocation,searchByType:this.model.state.searchByType,searchType:this.model.state.searchType},onSubmit:this.setSearch.bind(this),searchInputLabel:this.config.country===x.Z.COUNTRIES.US?this.content.searchInputLabelUS:this.content.searchInputLabel,sectionHeading:this.content.dealerSearchHeading,theme:v.D.THEMES.CHOOSE_A_DEALER}),g.jG.insert(this.searchBar.render(),this.domElement),this.domElement.classList.add(Q),this.domElement.classList.remove($),this.domElement.classList.remove(ee),t){var a=this.searchBar.element.querySelector(".".concat("form__input-field--can-reset"));null==a||a.focus()}}},{key:"createResultsView",value:function(){var e;this.model.setCurrentStep(2),this.resultsView=new G({content:this.content,country:this.config.country,filter:null===(e=this.config)||void 0===e?void 0:e.filter,language:this.config.language,isCreditApp:this.config.isCreditApp,model:this.model,onDealerSelectCallback:this.onDealerSelectCallback}),g.jG.insert(this.resultsView.render(),this.domElement),this.domElement.classList.remove(Q),this.domElement.classList.add($),this.domElement.classList.remove(ee)}},{key:"createChosenDealerView",value:function(e){this.model.setCurrentStep(3),this.chosenDealerView=new q({model:this.model,chosenDealer:e,disableChange:this.config.disableChange,showMap:this.config.showMap,isCreditApp:this.config.isCreditApp,showInventory:this.config.showInventory,content:this.content}),g.jG.insert(this.chosenDealerView.render(),this.domElement),this.domElement.classList.remove(Q),this.domElement.classList.remove($),this.domElement.classList.add(ee);var t=this.domElement.querySelector(".".concat("choose-a-dealer__dealer-name"));null==t||t.focus()}},{key:"setSearch",value:function(e){var t=e.searchLocation;this.model.setSearchLocation(null),this.model.setSearchByType(e.searchByType),this.model.setSearchString(e.searchString),this.model.setAutoSubmit(e.autoSubmit),this.model.setSearchLocation(t)}},{key:"dispatchChosenDealerUpdated",value:function(e){var t,a,n,r,s,i,l,o=this.model.state,c=o.searchString,d=o.searchByType;g.Jw.dispatchEvent(g.Jw.createCustomEvent(E.fD.CHOSEN_DEALER_UPDATED,{detail:{address:null!==(t=null==e?void 0:e.address)&&void 0!==t?t:"",city:null!==(a=null==e?void 0:e.city)&&void 0!==a?a:"",phone:null!==(n=null==e?void 0:e.phone)&&void 0!==n?n:"",chosenDealerName:null!==(r=null==e?void 0:e.name)&&void 0!==r?r:"",dealerId:null!==(s=null==e?void 0:e.dealerId)&&void 0!==s?s:"",searchByType:d,searchString:c,state:null!==(i=null==e?void 0:e.state)&&void 0!==i?i:"",zip:null!==(l=null==e?void 0:e.zip)&&void 0!==l?l:""}}))}},{key:"onDealerSelectCallback",value:function(e){var t=this,a=f.s.DATA_TYPES.LAST_SELECTED_DEALER;this.config.onDealerSelectValidate?this.config.onDealerSelectValidate(e.dealerId,e.country).then((function(n){n&&n!==D.Z.DEALER_API_ERROR.messageId?(t.dealerLocationPrioritization.set(a,e),t.model.setChosenDealer(e)):t.resultsView.showErrorMessageOnDealer(e.dealerId)})):(this.dealerLocationPrioritization.set(a,e),this.model.setChosenDealer(e))}},{key:"destroyChosenDealerView",value:function(){this.chosenDealerView.destroy(),this.dispatchChosenDealerUpdated(null),this.model.setChosenDealer(null)}},{key:"destroy",value:function(){this.detachEvents(),this.searchBar&&this.searchBar.destroy(),this.resultsView&&this.resultsView.destroy(),this.chosenDealerView&&this.destroyChosenDealerView()}},{key:"onChosenDealerValidate",value:function(){this.validate()}},{key:"validate",value:function(){var e=this.model.state,t=e.preferredDealer,a=e.lastSelectedDealer,n=e.currentStep,r=!0;t||a||(r=!1,1===n?this.searchBar.showError(this.content.emptyDealerErrorMessage,!1):this.resultsView.showErrorMessage()),this.valid=r}},{key:"isValid",value:function(){return this.valid}},{key:"getButtonStyle",value:function(e){return e===t.BUTTON_STYLES.SECONDARY?"button button_secondary":e===t.BUTTON_STYLES.LINK?"link link_primary":"button button_primary"}},{key:"dispatchInited",value:function(){g.Jw.dispatchEvent(g.Jw.createCustomEvent(E.fD.CHOSEN_DEALER_INITED,{detail:{instance:this}}))}},{key:"getInstance",value:function(){g.Jw.dispatchEvent(g.Jw.createCustomEvent(E.fD.CHOSEN_DEALER_SET_INSTANCE,{detail:{instance:this}}))}},{key:"setInstanceMode",value:function(e){this.coupledInstance=e}},{key:"focus",set:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.model.state.currentStep;e&&(1===t&&this.searchBar?this.searchBar.focus=!0:2===t&&this.resultsView&&(this.resultsView.focus=!0))}}]),t}(m.Q);(0,u.Z)(te,"BUTTON_STYLES",{LINK:"link",PRIMARY:"primary",SECONDARY:"secondary"}),(0,u.Z)(te,"FILTERS",{MB_DEALER:"mbDealer"})}}]);
//# sourceMappingURL=5f9050c412572d486e76.bundle.js.map
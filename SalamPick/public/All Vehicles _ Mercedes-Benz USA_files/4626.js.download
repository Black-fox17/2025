"use strict";(self.webpackChunk_mbusa_now_aem=self.webpackChunk_mbusa_now_aem||[]).push([[4626],{77498:function(e,t,i){i.d(t,{Qf:function(){return T},Qt:function(){return O},Tq:function(){return v},Xs:function(){return C},_g:function(){return E},aC:function(){return m},bY:function(){return g},j5:function(){return f},m7:function(){return I},p9:function(){return b}});var n=i(87757),r=i.n(n),a=i(15861),o=i(71002),s=i(4942),l=i(8357),c=i(48218),d=i(83224),u=i(27046);function h(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function p(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?h(Object(i),!0).forEach((function(t){(0,s.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var y={BYO:null,CPO:null,INVENTORY:null},m=function(e){var t=new d.T;return l.jG.append(t.render(),e),t},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bodyStyle,i=void 0===t?"":t,n=e.class,r=void 0===n?"":n,a=e.isAMG,o=void 0!==a&&a,s=e.options,l=void 0===s?{}:s,d=e.model,u=void 0===d?"":d,h=e.modelPrice,y=void 0===h?0:h,m=e.msrp,f=void 0===m?c.at.NO_MSRP_PRICE:m,v=e.name,g=void 0===v?"":v,S=e.vehicleName,I=void 0===S?"":S,b=e.year,O=void 0===b?0:b,C=l.exterior&&l.exterior.PAINT&&l.exterior.PAINT.length&&l.exterior.PAINT[0].id?l.exterior.PAINT[0].id:"";return p({},e,{bodyStyleId:i,classId:r,exteriorMetaColor:C,interiorMetaColor:l.interior&&l.interior.UPHOLSTERY&&l.interior.UPHOLSTERY.length?l.interior.UPHOLSTERY[0]:"",isAMG:JSON.parse(o),modelId:u,modelName:I.length?I:g,modelPrice:y||f,msrp:f,paint:{id:C},type:"",year:JSON.parse(O)})},v=function(e){var t=e.bodyStyleId,i=e.classId,n=e.exteriorMetaColor,r=e.modelId,a=e.modelName;return{class:i,bodyStyle:t,meta:{altTag:""},model:r,name:a,options:{exterior:{PAINT:[n]}},msrp:e.msrp,vehicleName:a,year:e.year}},g=function(e){var t;if(!e)return null;var i="object"===(0,o.Z)(e.address)?e.address.find((function(e){return e}))||{line2:""}:{line1:e.address,line2:""},n=i.state||e.state,r=e.address?null===(t=e.address[0])||void 0===t?void 0:t.location:"";return{city:i.city||e.city,dealerId:e.dealerId||e.id||"",distance:r,name:e.name||"",searchedLocation:null==e?void 0:e.searchedLocation,state:n&&n.length?n.toUpperCase():"",zip:i.zip||e.zip}},S=function(){var e=window.localStorage,t=Object.keys(e),i=[];return t.forEach((function(t){t.includes(c.I.LAST_BUILD)&&i.push(JSON.parse(e[t]))})),i.length?(i.sort((function(e,t){return t.expiryTimestamp-e.expiryTimestamp})),p({},i[0].data,{expiryTimestamp:i[0].expiryTimestamp,isLastStoredBuild:!0})):null},I=function(){var e=(0,a.Z)(r().mark((function e(){var t,i,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.UM.retrieve();case 2:return t=e.sent,(i=S())&&(y.BYO=i),n="INVENTORY",null!=t&&t.isNew||(n="CPO"),y[n]=t,e.abrupt("return",y);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(e,t){return"CPO"===e?t.CPO:"BYO_SUMMARY"===e?t.INVENTORY:t.BYO&&!t.INVENTORY?t.BYO:t[e]},O=function(e){var t=new Date;l.tO.localStorage.create(c.I.VEHICLE_FAVORITE,{dealerId:e.dealer.dealerId,isNew:e.isNew,recentlyViewed:!0,vin:e.vin},new Date(t.setDate(t.getDate()+60)))},C=function(){return l.tO.localStorage.read(c.I.VEHICLE_FAVORITE)},T=function(){var e={"dealer-id":"dealer_id","default-model":"default_model_code","cta-pref-1":"cta_pref_1",inventoryEnabled:"inventoryEnabled","inventory-hybriud":"inventory_hybrid","hybrid-type":"hybrid_type",mp1:"model_pref_1",model:"model","pref-year":"year",tnt2:"tnt2","vehicle-amount":"vehicle_amount",zip:"zip_code",zipcode:"zip_code"},t=(0,l.f1)(window.location),i={};return Object.keys(t).forEach((function(n){e[n]&&(i[e[n]]=t[n])})),i},E=function(){return!document.querySelector(".three-up-module__slots-container.three-up-module__slots-container--secondary.hide")}},53054:function(e,t,i){i.d(t,{Z:function(){return L}});var n=i(45987),r=i(42982),a=i(4942),o=i(15671),s=i(43144),l=i(8357),c=i(14569),d=i(82051),u=i(54127),h=i(28612),p=i(64528),y=i(37170),m=i(77498),f=i(20971),v=i(78618),g=i(7081);function S(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function I(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?S(Object(i),!0).forEach((function(t){(0,a.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):S(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var b="aria-label",O="module__image",C="module__image--bbd",T="module__image--shadow-image",E="show",D="three-up-module__slot-wrapper",k="three-up-module__slots-container__inner--two-up",N="three-up-module__slots-container__inner--one-up",L=function(){function e(t){var i=this;(0,o.Z)(this,e),Object.keys(t).forEach((function(e){i[e]=t[e]})),this.verifyConfig(),this.state={},this.vehiclePictureElms=null,this.imgDimensions=null,this.inventoryInterceptor=null,this.moduleVersion="base",this.isInventoryEnabled=this.personalizationConfig.isInventoryEnabled,this.recentlyViewedVehicle=t.recentlyViewedVehicle,this.mediaServerApi=d.W.getInstance(),this.isInventoryEnabled&&(this.inventoryInterceptor=new u.a(this.personalizationConfig)),this.setBaseBindings();var n=this.init();return this.showModule(),this.updateSlotImage={},n}return(0,s.Z)(e,[{key:"verifyConfig",value:function(){if(!this.element)throw new Error("Missing base element");if(!this.personalizationConfig)throw new Error("Missing recommendation & inventory service configuration");this.personalizationConfig.modifiers||(this.personalizationConfig.modifiers={}),this.overrideParams||(this.overrideParams={}),this.verifyModuleConfig()}},{key:"verifyModuleConfig",value:function(){if(!this.hybridType)throw Error("missing module type");this.dataTheme||(this.dataTheme=y.si.DEFAULT),this.moduleConfig||(this.moduleConfig={}),this.destroyCallback||(this.destroyCallback=l.ZT),this.setBaseModule||(this.setBaseModule=l.ZT),this.userProfile||(this.userProfile={}),this.vehicleData||(this.vehicleData={}),this.modelList||(this.modelList=[]),this.containerSelector||(this.containerSelector=""),this.getTabPriority||(this.getTabPriority=function(){return!0})}},{key:"setBaseBindings",value:function(){this.loadVehicleImagewithImageUrl=this.loadVehicleImagewithImageUrl.bind(this),this.loadVehicleImageWithMediaServer=this.loadVehicleImageWithMediaServer.bind(this)}},{key:"init",value:function(){this.carousel=null,this.state={loader:null,moduleFullName:"",modalDisclaimers:[],needLifeStyleHeadline:!1,slotList:[],initialRecommendationsLength:0},this.maxSlotAmount=this.moduleConfig.maxSlotAmount||3,this.bckgImages={};var e=p.Wp[this.hybridType];this.analyticsName=this.overrideParams.analyticsName||p.J1[e].ANALYTIC_NAME,this.lifestyleState=!1,this.userProfile=v.Z.getStore().userProfile,this.setModuleVersion("three-up"),this.setBindings(),this.cacheDOM(),this.attachEvents(),this.setupThreeUp(),this.setHeader()}},{key:"setBackgroudImages",value:function(){var e=[{name:"vin",src:y.rr.VIN[this.dataTheme]},{name:"non_vin",src:y.rr.NON_VIN[this.dataTheme]},{name:"non_vin_cpo",src:y.rr.NON_VIN.CPO},{name:"lifestyle",src:y.rr.LIFESTYLE[this.dataTheme]},{name:"lifestyleCpo",src:y.rr.CPO_LIFESTYLE[this.dataTheme]},{name:"registration",src:y.rr.REGISTRATION_BACKPLATE[this.dataTheme]},{name:"registration-background",src:y.rr.REGISTRATION_BACKPLATE_BACKGROUND[this.dataTheme]},{name:"registration-foreground",src:y.rr.REGISTRATION_BACKPLATE_FOREGROUND[this.dataTheme]}];this.preloadBackgroundImages(e)}},{key:"cacheDOM",value:function(){this.header=this.element.querySelector(".".concat("three-up-module__header")),this.moduleContainer=this.element.querySelector(".".concat("three-up-module__container")),this.slotsContainer=this.element.querySelector(".".concat("three-up-module__slots-container").concat(this.containerSelector)),this.slotsInnerContainer=this.slotsContainer.querySelector(".".concat("three-up-module__slots-container__inner"))}},{key:"setBindings",value:function(){this.destroy=this.destroy.bind(this),this.onBreakpointCross=this.onBreakpointCross.bind(this),this.revealSlots=this.revealSlots.bind(this)}},{key:"attachEvents",value:function(){l.sp.addBreakpointListener(this.onBreakpointCross)}},{key:"detachEvents",value:function(){l.sp.removeBreakpointListener(this.onBreakpointCross)}},{key:"destroy",value:function(e){var t=this.getState().loader;t&&t.destroy(),e||this.destroyCallback(),this.detachEvents()}},{key:"onBreakpointCross",value:function(){var e,t;l.sp.gte(l.sp.SIZES.LARGE)?null===(e=this.carousel)||void 0===e||e.deactivate():null===(t=this.carousel)||void 0===t||t.activate()}},{key:"updateState",value:function(e){this.state=I({},this.state,{},e)}},{key:"getState",value:function(){return I({},this.state)}},{key:"updateContainerCopy",value:function(){var e=this.getState(),t=e.hybridType,i=e.needLifeStyleHeadline,n=this.overrideParams,r=n.headline,a=n.dealer,o=p.Wp[t],s=p.J1[o].HEADLINES,l=s.DEFAULT.AUTH,c=s.DEFAULT.UNAUTH;return"fr"===h.Z.MBNAFTA_PAGEDATA.LANGUAGE&&["INVENTORY_HYBRID","PAYMENT","BUILD","MODELS","COMPARE","INVENTORY"].includes(o)&&(l=p.J1.INVENTORY_HYBRID.HEADLINES.DEALER.AUTH,c=p.J1.INVENTORY_HYBRID.HEADLINES.DEALER.UNAUTH),r?(l=r.AUTH,c=r.UNAUTH):i?(l=h.Z.I18N.READY_TO_START_AUTH,c=h.Z.I18N.READY_TO_START):t!==p.Wp.BYO_SUMMARY||a||0!==this.state.initialRecommendationsLength||(l=s.NO_ZIP.AUTH,c=s.NO_ZIP.UNAUTH),this.createPersonalizedHeader({authenticatedMessage:l,fallbackMessage:c})}},{key:"setHeader",value:function(){this.getTabPriority()&&(this.header.innerText=this.updateContainerCopy())}},{key:"updateContainer",value:function(e){if(!this.hasSecondTab){var t=this.getState().moduleFullName,i={blade:t};e&&(i.module={tiles:e.toString()}),this.moduleContainer.classList.add("".concat(t,"__container")),this.moduleContainer.setAttribute("data-analytics-container",JSON.stringify(i))}}},{key:"getSlotArray",value:function(e){return e.recommendations.filter((function(e){return e}))}},{key:"setupCarouselAndEmptySlots",value:function(e){this.slotsContainer.removeAttribute(b),this.setupSlots(e),this.slotsInnerContainer.classList.add(E)}},{key:"createCarousel",value:function(e){var t=e.map((function(){return(0,f.Z)()({getNode:!0})}));this.carousel=new c.Carousel(t,{deactivate:!0,navigationType:c.Carousel.CAROUSEL_TYPES.BOTTOM,transitionType:c.Carousel.TRANSITION_TYPES.SLIDING,labels:{next:h.Z.I18N.NEXT,prev:h.Z.I18N.PREVIOUS,skipAll:h.Z.I18N.SKIP_ALL_SLIDES,skipToStart:h.Z.I18N.SKIP_TO_SLIDES_START}}),l.jG.append(this.carousel.getCarousel(),this.slotsInnerContainer),2===e.length&&this.slotsInnerContainer.classList.add(k),1===e.length&&this.slotsInnerContainer.classList.add(N),this.onBreakpointCross()}},{key:"setupSlots",value:function(e){var t=this;this.slotsContainer.removeAttribute(b),this.createCarousel(e);var i=[],n=(0,r.Z)(this.slotsContainer.querySelectorAll(".".concat(D)));this.handleServiceImages(e),e.forEach((function(e,r){var a=n[r];a.classList.add("".concat(D,"--module-").concat(r));var o={classNames:{base:D},dealer:v.Z.getStore().dealer,index:r,slotContainer:a,slotData:e};i[r]=t.renderSlot(o)})),this.slotsInnerContainer.classList.add(E),this.updateState({slotList:i})}},{key:"clearSlot",value:function(e){var t=e.index,i=e.createNewSlot;if(this.getState().slotList[t].destroy(),i){var n=this.slotsContainer.querySelector(".".concat(D,"--module-").concat(t));if(n)return l.jG.empty(n),(0,m.aC)(n)}return null}},{key:"clearSlots",value:function(){var e=this,t=this.getState(),i=t.loader,n=t.slotList;this.slotsInnerContainer.classList.remove(E),n.forEach((function(t,i){return e.clearSlot({index:i})})),2===n.length&&this.slotsInnerContainer.classList.remove(k),1===n.length&&this.slotsInnerContainer.classList.remove(N),this.slotsInnerContainer.hasChildNodes()&&l.jG.empty(this.slotsInnerContainer),this.slotsContainer.setAttribute(b,h.Z.I18N.VEHICLES_ARE_LOADING),this.updateState({slotList:[],loader:i||(0,m.aC)(this.slotsContainer)})}},{key:"setSlotArrayAmount",value:function(e){var t=this.overrideParams.vehicle_amount||void 0;return e.slice(0,t)}},{key:"revealSlots",value:function(e){this.updateState({hasLifeStyle:!1});var t=I({},e,{recommendations:this.setSlotArrayAmount(e.recommendations)});this.updateState({initialRecommendationsLength:e.recommendations.length});var i=this.getSlotArray(t);if(i)if(i.length){var n=this.getState().loader;n&&(n.destroy(),this.updateState({loader:null})),this.updateContainer(i.length),this.setHeader(),this.setupCarouselAndEmptySlots(i),v.Z.dispatch((0,g.A_)(!1))}else this.destroy();else this.destroy(!0)}},{key:"setImages",value:function(e,t,i){this.bckgImages[e.name]=i?null:t}},{key:"hasVehicleData",value:function(){return""!==this.vehicleData.modelId}},{key:"preloadBackgroundImages",value:function(e){var t=this;e.forEach((function(e){try{var i=new Image;i.src=e.src,i.onload=function(){i.onload=null},i.onerror=function(){i.onload=null,t.setImages(e,i,!0)},t.setImages(e,i,!e.src)}catch(e){console.warn(e)}}))}},{key:"showModule",value:function(){this.element.querySelector(".".concat(this.moduleVersion,"-").concat("module__container")).classList.add(E)}},{key:"setModuleVersion",value:function(e){this.moduleVersion=e}},{key:"addLifestyleTileToRecommendations",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.textOnly,r=void 0===i||i,a=(0,n.Z)(t,["textOnly"]);this.lifestyleState&&v.Z.getStore().dealer&&(this.bckgImages.lifestyle||(r=!0),this.updateState({needLifeStyleHeadline:!r}),e.push(I({},a,{lifeStyleState:!0,textOnly:r})))}},{key:"loadVehicleImageWithMediaServer",value:function(e){var t=(0,m.aC)(e.vehicleElm);e.updateSlotImageCallBack&&(this.updateSlotImage[e.slot]=e.updateSlotImageCallBack),this.updateImagePath(I({},e,{loader:t}))}},{key:"loadVehicleImagewithImageUrl",value:function(e){var t=e.image,i=e.vehicleData,r=e.vehicleElm,a=(0,n.Z)(e,["image","vehicleData","vehicleElm"]);a.updateSlotImageCallBack&&(this.updateSlotImage[a.slot]=a.updateSlotImageCallBack);var o=(0,m.aC)(r);this.preloadImages(t,I({vehicleData:i,vehicleElm:r,loader:o},a))}},{key:"updateImagePath",value:function(e){var t=this,i=e.vehicleData,r=(0,n.Z)(e,["vehicleData"]),a=d.W.PRESET_CATEGORIES.MODEL;r.isByo&&(a=d.W.PRESET_CATEGORIES.BYO);var o=null;this.mediaServerApi.getBuildImage(i,{view:d.W.VIEW_TYPES.EXTERIOR,pov:d.W.POV_TYPES.FRONT,presetCategory:a}).then((function(e){return o=e,t.mediaServerApi.getMediaServerType({model:i.model,className:i.class,year:i.year.toString()})})).then((function(e){o.type=e,t.preloadImages(o,I({vehicleData:i},r))})).catch((function(e){console.warn("BaseModule.updateImagePath:mediaServerApi.getBuildImage",e),t.preloadImages({},I({vehicleData:i},r))}))}},{key:"buildImgObj",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,i=y.sc,n=y.AU,r={};return r.imgSrc=e.small&&e.small.retina||e.large&&e.large.retina||i,r.shadowImage=i,r.emptyImage=n,r.imgSrc===n&&this.handleShadowImage(t),r}},{key:"preloadImages",value:function(e,t){var i,r=this,a=t.vehicleData,o=t.vehicleElm,s=(0,n.Z)(t,["vehicleData","vehicleElm"]),l=new Image,c=this.buildImgObj(e.respObj,o);c&&s.slot&&null!==(i=this.updateSlotImage)&&void 0!==i&&i[s.slot]&&this.updateSlotImage[s.slot](c),l.classList.add("".concat(this.moduleVersion,"-").concat(C)),c.imgSrc===c.shadowImage&&(l.classList.add("".concat(this.moduleVersion,"-").concat(T)),l.classList.remove("".concat(this.moduleVersion,"-").concat(C))),l.onload=function(){r.imgDimensions={width:l.width,height:l.height},l.onload=null,l.classList.add("".concat(r.moduleVersion,"-").concat(O)),l.setAttribute("alt",""),r.renderVehicle(c,l,I({vehicleData:a,vehicleElm:o},s))},l.src=c.imgSrc?c.imgSrc.replace(/(&crop=(\d+),(\d+),(\d+),(\d+))/g,""):"",l.onerror=function(){c.imgSrc===c.shadowImage?(c.imgSrc=c.emptyImage,l.classList.remove("".concat(r.moduleVersion,"-").concat(T)),l.classList.add("".concat(r.moduleVersion,"-").concat("module__image--empty-image")),l.src=c.emptyImage,l.onerror=null):(c.imgSrc=c.shadowImage,l.classList.add("".concat(r.moduleVersion,"-").concat(T)),l.classList.remove("".concat(r.moduleVersion,"-").concat(C)),l.src=c.shadowImage),r.handleShadowImage(o)}}},{key:"renderVehicle",value:function(e,t,i){var n=i.vehicleElm,r=i.loader;if(i.isSwap&&null!=n){var a=n.querySelector(".".concat(this.moduleVersion,"-").concat(O));a&&n.removeChild(a)}l.jG.append(t,n),n.classList.add("".concat(this.moduleVersion,"-").concat("module__image-container")),r.destroy();var o=n.querySelector(".".concat(this.moduleVersion,"-").concat("module__image-placeholder"));o&&n.removeChild(o)}},{key:"createPersonalizedHeader",value:function(e){var t=e.authenticatedMessage,i=e.otherReplacements,n=void 0===i?[]:i,a=e.fallbackMessage,o=e.fallbackReplacements,s=void 0===o?[]:o,c=this.userProfile.loggedState&&this.userProfile.accountData.name&&this.userProfile.accountData.name.length>0,d=(0,l.NR)(a,s);return c&&(d=(0,l.NR)(t,[this.userProfile.accountData.name].concat((0,r.Z)(n)))),d}},{key:"handleShadowImage",value:function(){}},{key:"handleServiceImages",value:function(){}}]),e}()},30530:function(e,t,i){i.d(t,{Z:function(){return u}});var n=i(4942),r=i(15671),a=i(43144),o=i(11752),s=i(61120),l=i(83102),c=i(64528);function d(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}var u=function(){function e(t){var i;(0,r.Z)(this,e),null!==(i=this.super)&&void 0!==i&&i.constructor?this.super.constructor.call(this,t):(0,o.Z)((0,s.Z)(e.prototype),"constructor",this)&&(0,o.Z)((0,s.Z)(e.prototype),"constructor",this).call(this,t)}return(0,a.Z)(e,[{key:"setupThreeUp",value:function(){this.updateState({hybridType:"INVENTORY_HYBRID",isAllVins:0,moduleFullName:"".concat(this.moduleVersion,"-").concat(this.analyticsName.length?"".concat(this.analyticsName,"-"):this.analyticsName,"module"),nbOfRecommendations:0}),this.setUpBase()}},{key:"getSlotArray",value:function(t){var i,r=t.recommendations?t.recommendations.length:0,a=t.recommendations.filter((function(e){return!!e.vin&&0!==e.vin.length})).length,l=null!==(i=this.super)&&void 0!==i&&i.getSlotArray?this.super.getSlotArray.call(this,t):(0,o.Z)((0,s.Z)(e.prototype),"getSlotArray",this).call(this,t);if(!r)return this.hybridSlotIndex=0,l;var c=this.overrideParams.InventoryHybrid&&"true"===this.overrideParams.InventoryHybrid,u=!c;1===r&&(1===a&&!u||c)&&(l.push(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?d(Object(i),!0).forEach((function(t){(0,n.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},l[0],{vin:""})),r=2);var h,p;return this.hybridSlotIndex=3<r?2:r-1,t.recommendations[this.hybridSlotIndex]&&(a>0&&c&&null!==(h=t.recommendations[this.hybridSlotIndex])&&void 0!==h&&null!==(p=h.vin)&&void 0!==p&&p.length&&(a-=a),!(a<r&&u)||t.recommendations[this.hybridSlotIndex].vin&&t.recommendations[this.hybridSlotIndex].vin.length||(a+=a)),this.updateState({isAllVins:a===t.recommendations.length,nbOfRecommendations:r}),r<3&&this.addLifestyleTileToRecommendations(l),l}},{key:"updateContainerCopy",value:function(){var t,i=this.getState(),n=i.hybridType,r=i.isAllVins,a=i.needLifeStyleHeadline;if(r&&!a){var l=c.Wp[n],d=c.J1[l].HEADLINES;return this.createPersonalizedHeader({authenticatedMessage:d.DEALER.AUTH,fallbackMessage:d.DEALER.UNAUTH})}return null!==(t=this.super)&&void 0!==t&&t.updateContainerCopy?this.super.updateContainerCopy.call(this):(0,o.Z)((0,s.Z)(e.prototype),"updateContainerCopy",this).call(this)}},{key:"renderSlot",value:function(t){var i,n=t.classNames,r=t.dealer,a=t.index,c=t.slotContainer,d=t.slotData;if(a!==this.hybridSlotIndex||0===a)return null!==(i=this.super)&&void 0!==i&&i.renderSlot?this.super.renderSlot.call(this,{classNames:n,dealer:r,index:a,slotContainer:c,slotData:d}):(0,o.Z)((0,s.Z)(e.prototype),"renderSlot",this).call(this,{classNames:n,dealer:r,index:a,slotContainer:c,slotData:d});var u,h,p=this.getState().moduleFullName,y=this.bckgImages,m=this.personalizationConfig,f=this.inventoryInterceptor,v=this.isInventoryEnabled,g=this.loadVehicleImagewithImageUrl,S={bckgImages:y,classNames:n,dealer:r,doubleCta:this.doubleCta,inventoryInterceptor:f,personalizationConfig:m,isInventoryEnabled:v,loadVehicleImagewithImageUrl:g,moduleFullName:p,slotContainer:c,slotData:d,slotIndex:a,type:this.hybridType};return this.overrideParams.InventoryHybrid?"true"===this.overrideParams.InventoryHybrid?(delete d.vin,new l.Z(S)):(d.vin=d.vin&&d.vin.length?d.vin:"12345",null!==(u=this.super)&&void 0!==u&&u.renderSlot?this.super.renderSlot.call(this,{classNames:n,dealer:r,index:a,slotContainer:c,slotData:d}):(0,o.Z)((0,s.Z)(e.prototype),"renderSlot",this).call(this,{classNames:n,dealer:r,index:a,slotContainer:c,slotData:d})):d.vin&&0!==d.vin.length?null!==(h=this.super)&&void 0!==h&&h.renderSlot?this.super.renderSlot.call(this,{classNames:n,dealer:r,index:a,slotContainer:c,slotData:d}):(0,o.Z)((0,s.Z)(e.prototype),"renderSlot",this).call(this,{classNames:n,dealer:r,index:a,slotContainer:c,slotData:d}):new l.Z(S)}}]),e}()},70812:function(e,t,i){i.d(t,{Z:function(){return v}});var n=i(4942),r=i(42982),a=i(15671),o=i(43144),s=i(11752),l=i(61120),c=i(48218),d=i(83102),u=i(52024);function h(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}var p="BUILD",y="COMPARE",m="MODELS",f="PAYMENT",v=function(){function e(t){var i;(0,a.Z)(this,e),null!==(i=this.super)&&void 0!==i&&i.constructor?this.super.constructor.call(this,t):(0,s.Z)((0,l.Z)(e.prototype),"constructor",this)&&(0,s.Z)((0,l.Z)(e.prototype),"constructor",this).call(this,t)}return(0,o.Z)(e,[{key:"setupThreeUp",value:function(){this.updateState({hybridType:this.hybridType,isAllVins:0,moduleFullName:"".concat(this.moduleVersion,"-").concat(this.analyticsName,"-module"),nbOfRecommendations:0}),this.setUpBase()}},{key:"duplicateTile",value:function(e){return[].concat((0,r.Z)(e),(0,r.Z)(e))}},{key:"getRecommendationsWithCompareTile",value:function(e){var t=e.map((function(e){return{classId:e.classId,modelId:e.modelId,year:e.year}}));return e[this.hybridSlotIndex-1].compareData=t,e}},{key:"getRecommendationsWithBuildTile",value:function(e,t){return e.map((function(e){var i=t.colorPicker.filter((function(t){return t.modelCode===e.modelId}));return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?h(Object(i),!0).forEach((function(t){(0,n.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},e,{colorPicker:i[0]})}))}},{key:"getModifiedRecommendations",value:function(t,i){var n;return 1===i.length?this.duplicateTile(i):null!==(n=this.super)&&void 0!==n&&n.getSlotArray?this.super.getSlotArray.call(this,t):(0,s.Z)((0,l.Z)(e.prototype),"getSlotArray",this).call(this,t)}},{key:"setHybridSlotIndex",value:function(e){var t=e?e.length:0;this.hybridSlotIndex=1<t?1:t}},{key:"getSlotArray",value:function(t){var i,n,r=JSON.parse(JSON.stringify(t)),a=r.recommendations;if(!a.length)return this.hybridSlotIndex=0,null!==(n=this.super)&&void 0!==n&&n.getSlotArray?this.super.getSlotArray.call(this,r):(0,s.Z)((0,l.Z)(e.prototype),"getSlotArray",this).call(this,r);var o=this.getModifiedRecommendations(r,a);this.setHybridSlotIndex(o);var d=o[this.hybridSlotIndex-1];if(this.hybridType===f&&d.modelPrice===c.at.NO_MSRP_PRICE)return this.setBaseModule(),null;this.hybridType===y&&a.length&&(o=this.getRecommendationsWithCompareTile(o)),(this.hybridType===p||this.hybridType===m)&&null!==(i=t.colorPicker)&&void 0!==i&&i.length&&(o=this.getRecommendationsWithBuildTile(o,t)),t.recommendations.length<3&&this.addLifestyleTileToRecommendations(o);var u=o?o.length:0;return this.updateState({nbOfRecommendations:u}),o}},{key:"renderSlot",value:function(t){var i,n,r,a,o=t.classNames,c=t.dealer,h=t.index,v=t.slotContainer,g=t.slotData;if(h!==this.hybridSlotIndex-1)return null!==(r=this.super)&&void 0!==r&&r.renderSlot?null===(a=this.super)||void 0===a?void 0:a.renderSlot.call(this,{classNames:o,dealer:c,index:h,slotContainer:v,slotData:g}):(0,s.Z)((0,l.Z)(e.prototype),"renderSlot",this).call(this,{classNames:o,dealer:c,index:h,slotContainer:v,slotData:g});var S=this.getState().moduleFullName,I=this.bckgImages,b=this.personalizationConfig,O=this.inventoryInterceptor,C=this.isInventoryEnabled,T=this.loadVehicleImagewithImageUrl,E=this.loadVehicleImageWithMediaServer,D={bckgImages:I,classNames:o,dealer:c,doubleCta:this.doubleCta,inventoryInterceptor:O,personalizationConfig:b,isInventoryEnabled:C,loadVehicleImagewithImageUrl:T,loadVehicleImageWithMediaServer:E,moduleFullName:S,slotContainer:v,slotData:g,slotIndex:h,type:this.hybridType};switch(this.hybridType){case p:case m:return g.colorPicker?new u.Z(D):new d.Z(D);case y:case f:return new d.Z(D);default:return null!==(i=this.super)&&void 0!==i&&i.renderSlot?null===(n=this.super)||void 0===n?void 0:n.renderSlot.call(this,{classNames:o,dealer:c,index:h,slotContainer:v,slotData:g}):(0,s.Z)((0,l.Z)(e.prototype),"renderSlot",this).call(this,{classNames:o,dealer:c,index:h,slotContainer:v,slotData:g})}}}]),e}()},3350:function(e,t,i){i.d(t,{Z:function(){return E}});var n=i(4942),r=i(42982),a=i(15671),o=i(43144),s=i(11752),l=i(61120),c=i(52597),d=i(2774),u=i(78883),h=i(80159),p=i(64528),y=i(77498),m=i(75942),f=i(77279),v=i(78618),g=i(7081);function S(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}var I="slotType",b="registration",O="registrationType",C="pre-registration",T="post-registration",E=function(){function e(t){var i,n;(0,a.Z)(this,e),null!==(i=this.super)&&void 0!==i&&i.constructor?null===(n=this.super)||void 0===n||n.constructor.call(this,t):(0,s.Z)((0,l.Z)(e.prototype),"constructor",this)&&(0,s.Z)((0,l.Z)(e.prototype),"constructor",this).call(this,t)}return(0,o.Z)(e,[{key:"setupThreeUp",value:function(){var t,i,n=p.Wp[this.hybridType];this.initialRecommendations=[],this.registrationConfig=p.J1[n].REGISTRATION_CONFIG,this.setRegistrationModuleBindings(),this.doubleCta=p.J1[n].DOUBLE_CTA,this.nullState=p.J1[n].NULL_STATE,this.lifestyleState=p.J1[n].LIFESTYLE_STATE,this.registrationType=v.Z.getStore().registrationType,this.lastSavedBuildId=null,this.setBackgroudImages(),null!==(t=this.super)&&void 0!==t&&t.setupThreeUp?null===(i=this.super)||void 0===i||i.setupThreeUp.call(this):(0,s.Z)((0,l.Z)(e.prototype),"setupThreeUp",this)&&(0,s.Z)((0,l.Z)(e.prototype),"setupThreeUp",this).call(this)}},{key:"setRegistrationModuleBindings",value:function(){this.registrationComplete=this.registrationComplete.bind(this),this.renderSlotOnSavedComplete=this.renderSlotOnSavedComplete.bind(this),this.storeLastBuild=this.storeLastBuild.bind(this),this.storeRecentlyViewed=this.storeRecentlyViewed.bind(this)}},{key:"getIsRegistrationRecentlyViewed",value:function(e){var t=!1;if(!this.recentlyViewedVehicle)return t;if(!this.recentlyViewedVehicle.isLastStoredBuild&&!this.hasRegistrationBackgroundImages())return console.warn("3UP Registration Recently Viewed Tile: no background images"),t;var i=this.recentlyViewedVehicle.vin;return!e.some((function(e){return i&&i===e.vin}))||(console.warn("3UP Registration Tile: recently viewed/last build is already in recommendations"),t)}},{key:"getShowResgistrationTileWithRegisteredUser",value:function(){return!!v.Z.getStore().locationChange&&this.registrationType===T}},{key:"getSlotArray",value:function(t){var i,a,o,d,u=null!==(i=this.super)&&void 0!==i&&i.getSlotArray?this.super.getSlotArray.call(this,t):(0,s.Z)((0,l.Z)(e.prototype),"getSlotArray",this).call(this,t);if(!u.length)return u;var h=(new c.$S).getProfile(),p=Boolean(null===(a=h.accountData)||void 0===a||null===(o=a.firstName)||void 0===o?void 0:o.length);if((h.loggedState||p)&&!this.getShowResgistrationTileWithRegisteredUser())return u;this.initialRecommendations=(0,r.Z)(u);var y=(d={},(0,n.Z)(d,I,b),(0,n.Z)(d,O,this.registrationType),(0,n.Z)(d,"isRecentlyViewed",this.getIsRegistrationRecentlyViewed(u)),d),m=this.maxSlotAmount-1;return u.length>m&&(u=u.slice(0,m)),[].concat((0,r.Z)(u),[y])}},{key:"renderSlot",value:function(t){var i,r=t.classNames,a=t.dealer,o=t.index,c=t.slotContainer,p=t.slotData,y=this.getState().moduleFullName;if(p[I]!==b){var m,f;if(null!==(m=this.super)&&void 0!==m&&m.renderSlot)return null===(f=this.super)||void 0===f?void 0:f.renderSlot.call(this,{classNames:r,dealer:a,index:o,slotContainer:c,slotData:p});if((0,s.Z)((0,l.Z)(e.prototype),"renderSlot",this))return(0,s.Z)((0,l.Z)(e.prototype),"renderSlot",this).call(this,{classNames:r,dealer:a,index:o,slotContainer:c,slotData:p})}var v=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?S(Object(i),!0).forEach((function(t){(0,n.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):S(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},{goToInventoryCallback:this.goToInventory.bind(this),loadVehicleImagewithImageUrl:this.loadVehicleImagewithImageUrl,loadVehicleImageWithMediaServer:this.loadVehicleImageWithMediaServer,registrationComplete:this.registrationComplete,onLogInLinkClickCallback:this.onLogInLinkClickCallback.bind(this)},(i={bckgImages:this.bckgImages,classNames:r,cpoVdpLink:this.personalizationConfig.cpoVdpUrl,doubleCta:p[O]===C,inventoryInterceptor:this.inventoryInterceptor},(0,n.Z)(i,O,p[O]),(0,n.Z)(i,"lastSavedBuildId",this.lastSavedBuildId),(0,n.Z)(i,"linkUrl",this.getInventoryUrl()),(0,n.Z)(i,"moduleFullName",y),(0,n.Z)(i,"registrationConfig",this.registrationConfig),(0,n.Z)(i,"slotContainer",c),(0,n.Z)(i,"slotIndex",o),(0,n.Z)(i,"personalizationConfig",this.personalizationConfig),(0,n.Z)(i,"recentlyViewedVehicle",this.recentlyViewedVehicle),(0,n.Z)(i,"vdpLinkUrl",this.getVDPUrl()),(0,n.Z)(i,"vehicleData",this.vehicleData||{}),i));return p.isRecentlyViewed?this.recentlyViewedVehicle.isLastStoredBuild?(v.tileType="LAST_BUILD",new u.Z(v)):new h.Z(v):(v.tileType="REECENTLY_VIEWED",new d.Z(v))}},{key:"getPostRegistrationSlotData",value:function(){var e,t,i=this.initialRecommendations.length<this.maxSlotAmount,r=i?this.initialRecommendations.length:this.maxSlotAmount-1,a=this.getIsRegistrationRecentlyViewed(this.initialRecommendations),o=null===(e=this.initialRecommendations)||void 0===e?void 0:e[r];return(a||i)&&(t={},(0,n.Z)(t,I,b),(0,n.Z)(t,O,this.registrationType),(0,n.Z)(t,"isRecentlyViewed",a),(0,n.Z)(t,"lastSavedBuildId",this.lastSavedBuildId),o=t),o}},{key:"renderSlotOnSavedComplete",value:function(){this.updateRegistrationType();var e=this.initialRecommendations.length<this.maxSlotAmount?this.initialRecommendations.length:this.maxSlotAmount-1,t=this.clearSlot({index:e,createNewSlot:!0});t&&t.destroy(),this.renderSlot({classNames:{},slotContainer:this.slotsContainer.querySelector(".".concat("three-up-module__slot-wrapper","--module-").concat(e)),slotData:this.getPostRegistrationSlotData(),index:e})}},{key:"storeLastBuild",value:function(e){return(0,f.l3)(e).then((function(e){return(0,m.io)(e)})).then((function(e){return e}))}},{key:"storeRecentlyViewed",value:function(e){return v.Z.dispatch((0,g.hb)(e))}},{key:"updateRegistrationType",value:function(){return this.registrationType=T,v.Z.dispatch((0,g.zn)(T))}},{key:"registrationComplete",value:function(){var e=this,t=this.recentlyViewedVehicle,i={DEFAULT:this.renderSlotOnSavedComplete,LAST_BUILD:this.storeLastBuild,RECENTLY_VIEWED_VIN:this.storeRecentlyViewed};t?i[t.isLastStoredBuild?"LAST_BUILD":"RECENTLY_VIEWED_VIN"](t).then((function(t){var i;if(console.log(t),t.error)throw new Error(t.error);return e.lastSavedBuildId=null===(i=t.result)||void 0===i?void 0:i.buildId,e.updateRegistrationType()})).then((function(){return e.renderSlotOnSavedComplete()})).catch((function(e){return console.error("Save Build",e)})):i.DEFAULT()}},{key:"onLogInLinkClickCallback",value:function(){this.recentlyViewedVehicle.vin&&((new c.$S).createAuthRedirectCookie(),(0,y.Qt)(this.recentlyViewedVehicle))}},{key:"hasRegistrationBackgroundImages",value:function(){var e=this.bckgImages;return Object.keys(e).filter((function(t){return e[t]&&t.includes("".concat("registration","-"))})).length>1}}]),e}()},98690:function(e,t,i){i.d(t,{Z:function(){return I}});var n=i(4942),r=i(15671),a=i(43144),o=i(11752),s=i(61120),l=i(8357),c=i(28612),d=i(63155),u=i(83663),h=i(38374),p=i(99273),y=i(47085),m=i(59248),f=i(26437);function v(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function g(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?v(Object(i),!0).forEach((function(t){(0,n.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var S={DATA_THEME_AMG:"amg",EVENT_OFFER_TYPE:"EVENT",GENERAL_OFFER_TYPE:"GENERAL",OFFERS:"OFFERS",QUERY_STRING:"hybrid-type",SINGULAR_OFFER_TYPE:"SINGULAR",THREE_UP_MODULE_TYPE:"hybrid"},I=function(){function e(t){var i,n;(0,r.Z)(this,e),null!==(i=this.super)&&void 0!==i&&i.constructor?null===(n=this.super)||void 0===n||n.constructor.call(this,t):(0,o.Z)((0,s.Z)(e.prototype),"constructor",this)&&(0,o.Z)((0,s.Z)(e.prototype),"constructor",this).call(this,t)}return(0,a.Z)(e,[{key:"setupThreeUp",value:function(){this.updateState({hybridType:S.OFFERS,moduleFullName:"".concat(this.moduleVersion,"-module")}),this.setUpBase()}},{key:"reArrangeRecommendations",value:function(e){var t=[],i=[],n=[];return e.forEach((function(e){var r;null!==(r=e.vin)&&void 0!==r&&r.length?e.available?i.push(e):n.push(e):t.push(e)})),[].concat(i,n,t).filter((function(e){return e}))}},{key:"getSlotArray",value:function(t){var i,n=JSON.parse(JSON.stringify(t)),r=n.offer,a=n.recommendations;if(null==r||!r.offerType||!a.length){var l;if(null!==(l=this.super)&&void 0!==l&&l.getSlotArray)return this.super.getSlotArray.call(this,n);if((0,o.Z)((0,s.Z)(e.prototype),"getSlotArray",this))return(0,o.Z)((0,s.Z)(e.prototype),"getSlotArray",this).call(this,n)}var c=this.getParsedOffer(r);return this.setOfferType(c),null!==(i=this.personalizationConfig.modifiers)&&void 0!==i&&i.inventoryShuffle&&(a=this.reArrangeRecommendations(a)),a.splice(0,0,c),1===n.recommendations.length&&this.addLifestyleTileToRecommendations(a),a}},{key:"getOfferType",value:function(e,t){var i=S.GENERAL_OFFER_TYPE;return e.offerPage?t.toUpperCase():i}},{key:"getOfferProps",value:function(e){var t=c.Z.MBNAFTA_PAGEDATA.LANGUAGE,i={};if(e===S.EVENT_OFFER_TYPE.toLowerCase()){var n="fr"===t?m:p;i.offerPage=n.result.offer.offerPage,i.salesEventName=n.result.offer.salesEventName,i.eventPromoBGImage=n.result.offer.eventPromoBGImage}if(e===S.SINGULAR_OFFER_TYPE.toLowerCase()){var r="fr"===t?f:y;i.offerPage=r.result.offer.offerPage}return i}},{key:"getParsedOffer",value:function(e){var t=(0,l.f1)(window.location)[S.QUERY_STRING];if(!t)return e;var i=this.getOfferProps(t),n=this.getOfferType(g({},e,{},i),t);return g({},e,{},i,{offerType:n})}},{key:"setOfferType",value:function(e){var t=e.offerType;this.updateState({hybridType:t,moduleFullName:"".concat(this.moduleVersion,"-").concat(t.toLowerCase(),"-").concat(this.analyticsName,"-module")})}},{key:"renderSlot",value:function(t){var i=t.classNames,n=t.dealer,r=t.index,a=t.slotContainer,l=t.slotData;if(!l.offerType){var c;if(null!==(c=this.super)&&void 0!==c&&c.renderSlot)return this.super.renderSlot.call(this,{classNames:i,dealer:n,index:r,slotContainer:a,slotData:l});if((0,o.Z)((0,s.Z)(e.prototype),"renderSlot",this))return(0,o.Z)((0,s.Z)(e.prototype),"renderSlot",this).call(this,{classNames:i,dealer:n,index:r,slotContainer:a,slotData:l})}var p=this.getState().moduleFullName,y=this.bckgImages,m=this.personalizationConfig,f={bckgImages:y,classNames:i,dealer:n,inventoryInterceptor:this.inventoryInterceptor,personalizationConfig:m,isInventoryEnabled:this.isInventoryEnabled,loadVehicleImageWithMediaServer:this.loadVehicleImageWithMediaServer,moduleFullName:p,slotContainer:a,slotData:l,slotIndex:r};switch(l.offerType){case S.SINGULAR_OFFER_TYPE:return new h.Z(f);case S.EVENT_OFFER_TYPE:return new d.Z(f);default:return new u.Z(f)}}},{key:"handleServiceImages",value:function(e){var t=e.filter((function(e){return e.offerType})).find((function(e){return e.offerType===S.GENERAL_OFFER_TYPE})),i=[];t&&i.push({name:"general-offer",src:t.salesHeroImage}),i.length&&this.preloadBackgroundImages(i)}}]),e}()},29016:function(e,t,i){i.d(t,{Z:function(){return g}});var n=i(4942),r=i(42982),a=i(15671),o=i(43144),s=i(82963),l=i(11752),c=i(61120),d=i(60136),u=i(53054),h=i(84843),p=i(38164),y=i(46301),m=i(64528),f=i(78618);function v(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}var g=function(e){function t(){return(0,a.Z)(this,t),(0,s.Z)(this,(0,c.Z)(t).apply(this,arguments))}return(0,d.Z)(t,e),(0,o.Z)(t,[{key:"setupThreeUp",value:function(){this.updateState({hybridType:this.hybridType,moduleFullName:"".concat(this.moduleVersion,"-").concat(this.analyticsName,"-module"),hasMultipleDealers:!0}),this.setUpBase()}},{key:"setUpBase",value:function(){var e=m.Wp[this.getState().hybridType];this.doubleCta=m.J1[e].DOUBLE_CTA,this.nullState=m.J1[e].NULL_STATE,this.lifestyleState=m.J1[e].LIFESTYLE_STATE,this.setBackgroudImages(),this.updateContainer()}},{key:"geDefaultModelData",value:function(){var e=f.Z.getStore().activeModelsList,t=[this.vehicleData.modelId].concat((0,r.Z)(this.modelList)).find((function(t){return e[t.toUpperCase()]}));return t?e[t.toUpperCase()].model:null}},{key:"setHasMultipleDealers",value:function(e){var t=e.some((function(t){return t.dealerId!==e[0].dealerId}));this.updateState({hasMultipleDealers:t})}},{key:"hasNullStateTile",value:function(e){var t=f.Z.getStore().dealer;return!!this.geDefaultModelData()&&Boolean(!e.length&&this.nullState&&(null==t?void 0:t.dealerId)||e.length<this.maxSlotAmount)}},{key:"hasLifeStylesTile",value:function(e,t){return!!t.recommendationsDealer&&Boolean(this.lifestyleState&&e.length<2)}},{key:"getSlotArray",value:function(e){if(!this.modelList.length&&!this.hasVehicleData())return[];var i=(0,l.Z)((0,c.Z)(t.prototype),"getSlotArray",this).call(this,e);if(this.hasNullStateTile(i)&&i.push({noInventory:!0,vehicleData:this.geDefaultModelData()}),this.hasLifeStylesTile(i,e)){var n=Boolean(i.length||this.geDefaultModelData());this.bckgImages.lifestyleCpo||(n=!0),this.updateState({needLifeStyleHeadline:!n}),i.push({lifeStyleState:!0,recommendationsDealer:e.recommendationsDealer,textOnly:n})}return this.setHasMultipleDealers(i),i}},{key:"updateContainerCopy",value:function(){var e=this.getState(),i=e.hasMultipleDealers,n=e.hybridType,r=e.needLifeStyleHeadline,a=this.overrideParams.headline,o=m.Wp[n],s=m.J1[o].HEADLINES,d="",u="";return i||r?(0,l.Z)((0,c.Z)(t.prototype),"updateContainerCopy",this).call(this):(a&&(d=a.AUTH,u=a.UNAUTH),this.createPersonalizedHeader({authenticatedMessage:d.length?d:s.DEALER.AUTH,fallbackMessage:u.length?u:s.DEALER.UNAUTH}))}},{key:"goToInventory",value:function(e){e.preventDefault();var t={};this.recentlyViewedVehicle&&(t.vehicleInfo={bodyStyle:this.recentlyViewedVehicle.bodyStyleId,class:this.recentlyViewedVehicle.classId,model:this.recentlyViewedVehicle.modelId}),this.inventoryInterceptor.goTo(!1,t)}},{key:"getInventoryUrl",value:function(){return this.personalizationConfig.cpoInventoryUrl}},{key:"renderSlot",value:function(e){var t=e.classNames,i=e.dealer,r=e.index,a=e.slotContainer,o=e.slotData,s=this.getState().moduleFullName,l=this.bckgImages,c=this.inventoryInterceptor,d=this.isInventoryEnabled,u=this.personalizationConfig,m=this.loadVehicleImagewithImageUrl,g=this.loadVehicleImageWithMediaServer,S=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?v(Object(i),!0).forEach((function(t){(0,n.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({activeModelsList:f.Z.getStore().activeModelsList},o,{bckgImages:l,classNames:t,dataTheme:this.dataTheme,dealer:i,doubleCta:!1,isCPO:!0,inventoryInterceptor:c,isInventoryEnabled:d,loadVehicleImageWithMediaServer:g,loadVehicleImagewithImageUrl:m,moduleFullName:s,modelList:this.modelList,moduleVersion:this.moduleVersion,personalizationConfig:u,slotContainer:a,slotData:o,slotIndex:r,showDealer:!0});return o.lifeStyleState?new y.Z(S):(S.doubleCta=this.doubleCta,o.noInventory?(S.slotData=o.vehicleData,new p.Z(S)):new h.Z(S))}},{key:"getVDPUrl",value:function(){return this.personalizationConfig.vdpUrl}}]),t}(u.Z)},3944:function(e,t,i){i.d(t,{Z:function(){return I}});var n=i(4942),r=i(15671),a=i(43144),o=i(48218),s=i(8357),l=i(73334),c=i(28612),d=i(77498),u=i(89048),h=i(64528),p=i(83803),y=i(78618);function m(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?m(Object(i),!0).forEach((function(t){(0,n.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var v="aria-label",g="show",S="three-up-module__search-bar",I=function(){function e(t){var i=t.changeDealerCallback,n=void 0===i?s.ZT:i,a=t.element,o=t.onSubmitCallback,l=void 0===o?s.ZT:o;return(0,r.Z)(this,e),this.changeDealerCallback=n,this.dealerInfoContainer=a,this.onSubmitCallback=l,this.state={changeLocationCTA:null,dealerSelectorModal:null,locationBar:null,isLocationOutdated:!0,loader:null},this.setBindings(),this.init(),this}return(0,a.Z)(e,[{key:"init",value:function(){this.cacheDOM(),this.updateState({loader:(0,d.aC)(this.dealerInfoContainer)})}},{key:"destroy",value:function(){this.detachEvents()}},{key:"attachEvents",value:function(){var e=this.getState().changeLocationCTA;e&&e.addEventListener(o.FP.CLICK,this.onChangeLocationClick)}},{key:"detachEvents",value:function(){var e=this.getState().changeLocationCTA;e&&e.removeEventListener(o.FP.CLICK,this.onChangeLocationClick)}},{key:"cacheDOM",value:function(){this.dealerInfoInnerContainer=this.dealerInfoContainer.querySelector(".".concat("three-up-module__dealer-info__inner"))}},{key:"showDealerInfo",value:function(e){this.dealerInfoContainer.querySelector(".".concat(S)).classList.remove(g);var t=this.dealerInfoInnerContainer.querySelector(".".concat("three-up-module__dealer-info__address")),i=e.city,n=e.state,r=e.zip;t.innerText="".concat(i,", ").concat(n," ").concat(r)}},{key:"updateSubHeaderCopy",value:function(){var e=h.Wp[y.Z.getStore().moduleType[h.lh.PRIMARY]];return h.J1[e].SUDBHEADER_NO_DEALER}},{key:"updateDealerInfoAnalytics",value:function(){this.getState().changeLocationCTA.setAttribute("data-analytics-trigger","".concat("cta-change-dealer"))}},{key:"createDealerSelector",value:function(){var e=this.getState().changeLocationCTA;this.updateState({dealerSelectorModal:new l.O2({callingElementCta:e,dealer:y.Z.getStore().dealer,displaySelectedDealer:!0,enableSelectedDealer:!0,filterBy:l.O2.FILTER_TYPES.INVENTORY,isNewInventory:!0,onClose:this.closeDealerSelector,onDealerContinue:this.updateDealerData})})}},{key:"createZipCodeSelector",value:function(){var e=this.dealerInfoContainer.querySelector(".".concat(S)),t=y.Z.getStore().dealer;this.searchBar=new p.Z({defaultLocation:t&&t.zip,element:e,onSubmitCallback:this.onSubmitCallback,onSuccessCallback:this.destroyZipcodeSelected}),e.classList.add(g),s.jG.empty(this.dealerInfoInnerContainer)}},{key:"destroyZipcodeSelected",value:function(){var e=this.dealerInfoContainer.querySelector(".".concat(S));this.searchBar.destroy(),e.classList.remove(g),this.updateState({isLocationOutdated:!0}),this.clearAdress()}},{key:"closeDealerSelector",value:function(){this.getState().dealerSelectorModal.close(),this.updateState({dealerSelectorModal:null})}},{key:"revealLocation",value:function(){var e=this.getState().loader;e&&(e.destroy(),this.updateState({loader:null})),this.dealerInfoContainer.removeAttribute(v),this.dealerInfoInnerContainer.hasChildNodes()?this.dealerInfoInnerContainer.classList.remove(g):this.renderDealerInfo();var t=c.Z.I18N.SELECT_YOUR_DEALER,i=y.Z.getStore().location;i&&Object.values(i).every((function(e){return e.length}))?(t=c.Z.I18N.CHANGE_ZIPCODE,this.showDealerInfo(i)):this.createZipCodeSelector(),this.getState().changeLocationCTA.innerText=t,this.dealerInfoInnerContainer.classList.add(g),this.updateState({isLocationOutdated:!1}),this.updateDealerInfoAnalytics(),this.attachEvents()}},{key:"updateDealerData",value:function(e){var t=y.Z.getStore().dealer,i=!1;t&&t.dealerId?e.dealerId?i=t.dealerId!==e.dealerId:e.id&&(i=t.dealerId!==e.id):i=!0,i&&(this.updateState({isLocationOutdated:!0}),this.changeDealerCallback(e)),this.closeDealerSelector()}},{key:"renderDealerInfo",value:function(){var e=this.updateSubHeaderCopy();s.jG.append((0,u.Z)({noDealerSubHeader:e,isLocation:!0})({getNode:!0}),this.dealerInfoInnerContainer),this.updateState({changeLocationCTA:this.dealerInfoInnerContainer.querySelector(".".concat("three-up-module__dealer-info__change-cta"))})}},{key:"onChangeLocationClick",value:function(){this.createZipCodeSelector()}},{key:"clearAdress",value:function(){this.detachEvents(),this.dealerInfoInnerContainer.hasChildNodes()?(this.dealerInfoInnerContainer.addEventListener(o.FP.TRANSITION_END,this.onLocationInfoTransitionEnd),this.dealerInfoInnerContainer.classList.remove(g)):this.onLocationInfoTransitionEnd()}},{key:"onLocationInfoTransitionEnd",value:function(){var e=this.getState(),t=e.isLocationOutdated,i=e.loader;t?(s.jG.empty(this.dealerInfoInnerContainer),this.dealerInfoContainer.setAttribute(v,c.Z.I18N.VEHICLES_ARE_LOADING),i||this.updateState({loader:(0,d.aC)(this.dealerInfoContainer)})):this.dealerInfoInnerContainer.hasChildNodes()&&this.dealerInfoInnerContainer.removeEventListener(o.FP.TRANSITION_END,this.onLocationInfoTransitionEnd)}},{key:"setBindings",value:function(){this.onChangeLocationClick=this.onChangeLocationClick.bind(this),this.updateDealerData=this.updateDealerData.bind(this),this.closeDealerSelector=this.closeDealerSelector.bind(this),this.revealLocation=this.revealLocation.bind(this),this.onLocationInfoTransitionEnd=this.onLocationInfoTransitionEnd.bind(this),this.destroyZipcodeSelected=this.destroyZipcodeSelected.bind(this)}},{key:"updateState",value:function(e){this.state=f({},this.state,{},e)}},{key:"getState",value:function(){return f({},this.state)}}]),e}()},27884:function(e,t,i){i.d(t,{Z:function(){return v}});var n=i(4942),r=i(15671),a=i(43144),o=i(82963),s=i(11752),l=i(61120),c=i(60136),d=i(53054),u=i(1530),h=i(44356),p=i(46301),y=i(64528);function m(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?m(Object(i),!0).forEach((function(t){(0,n.Z)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var v=function(e){function t(){return(0,r.Z)(this,t),(0,o.Z)(this,(0,l.Z)(t).apply(this,arguments))}return(0,c.Z)(t,e),(0,a.Z)(t,[{key:"setupThreeUp",value:function(){var e=y.Wp[this.hybridType];this.doubleCta=y.J1[e].DOUBLE_CTA,this.updateState({hybridType:this.hybridType,moduleFullName:"".concat(this.moduleVersion,"-").concat(this.analyticsName.length?"".concat(this.analyticsName,"-"):this.analyticsName,"module")}),this.setUpBase()}},{key:"setUpBase",value:function(){var e=y.Wp[this.getState().hybridType];this.nullState=y.J1[e].NULL_STATE,this.defaultTileState=y.J1[e].DEFAULT_TILE_STATE,this.lifestyleState=y.J1[e].LIFESTYLE_STATE,this.setBackgroudImages(),this.updateContainer()}},{key:"getSlotArray",value:function(e){var i=(0,s.Z)((0,l.Z)(t.prototype),"getSlotArray",this).call(this,e);return i.length>0?i:this.getNullState()}},{key:"getNullState",value:function(){var e=[],t=this.hasVehicleData();return t&&this.defaultTileState&&e.push(f({},this.vehicleData,{jellyBeanOverride:!0})),t&&this.nullState&&e.push({nullState:!0}),this.addLifestyleTileToRecommendations(e,{textOnly:!1}),e}},{key:"goToInventory",value:function(e){e.preventDefault();var t=this.vehicleData,i={vehicleInfo:{bodyStyle:t.bodyStyle,class:t.class,model:t.model}};if(this.recentlyViewedVehicle){var n=this.recentlyViewedVehicle;i={dealer:n.dealer,vehicleInfo:{bodyStyle:n.bodyStyleId,class:n.classId,model:n.modelId}}}this.inventoryInterceptor.goTo(!0,i)}},{key:"goToVDP",value:function(e){e.preventDefault(),this.inventoryInterceptor.goToVDP(!0,this.recentlyViewedVehicle.dealer,this.recentlyViewedVehicle)}},{key:"getInventoryUrl",value:function(){return this.personalizationConfig.inventoryUrl}},{key:"getVDPUrl",value:function(){return this.personalizationConfig.vdpUrl}},{key:"renderSlot",value:function(e){var t=e.classNames,i=e.dealer,n=e.index,r=e.slotContainer,a=e.slotData,o=this.getState().moduleFullName,s=this.hybridType,l=this.bckgImages,c=this.inventoryInterceptor,d=this.isInventoryEnabled,y=this.personalizationConfig,m=this.loadVehicleImagewithImageUrl,v=this.loadVehicleImageWithMediaServer,g={bckgImages:l,classNames:t,dealer:i,doubleCta:this.doubleCta,moduleType:s,slotContainer:r,slotIndex:n};return a.nullState&&this.vehicleData.modelName.length&&this.vehicleData.year?(g=f({},g,{moduleFullName:o,personalizationConfig:y,slotData:this.vehicleData,loadVehicleImageWithMediaServer:v}),new u.Z(g)):a.lifeStyleState?(g=f({},g,{},a,{dataTheme:this.dataTheme,dealer:i,doubleCta:!1,hasDealer:!1,moduleFullName:o,moduleVersion:this.moduleVersion,personalizationConfig:y}),new p.Z(g)):(g=f({},g,{dealer:i,doubleCta:this.doubleCta,inventoryInterceptor:c,isInventoryEnabled:d,moduleFullName:o,personalizationConfig:y,slotData:a,loadVehicleImagewithImageUrl:m,loadVehicleImageWithMediaServer:v}),new h.Z(g))}}]),t}(d.Z)}}]);
//# sourceMappingURL=4626.js.map